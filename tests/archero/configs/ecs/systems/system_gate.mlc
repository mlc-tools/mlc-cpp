class ecs/ComponentGate<ComponentBase>
{
    float radius = 64
    bool clean = false
}

class ecs/SystemGate
{
    fn void update(ModelEcsBase* model, float dt)
    {
        model->each<ComponentGate, Transform>(
            [&](auto& gate, auto& transform)
            {
                auto player_transform = model->get<Transform>(model->player_id);
                auto dist = player_transform->position.get_distance(transform->position);
                if(dist < gate->radius)
                {
                    model->event_wave_next.notify();
                    gate->clean = true;
                }
            });
        list_do_if(model->components_gate, (gate :> gate->clean :> model->remove_entity(gate->id)));
    }
}